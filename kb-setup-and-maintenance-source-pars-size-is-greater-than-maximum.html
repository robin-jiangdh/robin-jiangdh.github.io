<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex">  <meta name="built-on" content="2023-12-17T22:54:22.1527583"><meta name="build-number" content="${buildNumber}">       <title>source parts size is greater than the current maximum | blog</title><script id="virtual-toc-data" type="application/json">[{"id":"source-parts-size-is-greater-than-the-current-maximum-linktitle-source-parts-sizeis-greater-than-the-current-maximum-weight-100-description-source-parts-size-is-greater-than-the-current-maximum","level":0,"title":"#source parts size is greater than the current maximum\nlinkTitle: \"source parts sizeis greater than the current maximum\"\nweight: 100\ndescription: \u003e-\nsource parts size (...) is greater than the current maximum (...)","anchor":"#source-parts-size-is-greater-than-the-current-maximum-linktitle-source-parts-sizeis-greater-than-the-current-maximum-weight-100-description-source-parts-size-is-greater-than-the-current-maximum"},{"id":"symptom","level":0,"title":"Symptom","anchor":"#symptom"},{"id":"cause","level":0,"title":"Cause","anchor":"#cause"},{"id":"action","level":0,"title":"Action","anchor":"#action"}]</script><script id="topic-shortcuts" type="application/json"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="source parts size is greater than the current maximum | blog"/><meta property="og:description" content=""/><meta property="og:image" content=""/><meta property="og:site_name" content="blog Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="/1.0/kb-setup-and-maintenance-source-pars-size-is-greater-than-maximum.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="source parts size is greater than the current maximum | blog"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "/1.0/kb-setup-and-maintenance-source-pars-size-is-greater-than-maximum.html#webpage", "url": "/1.0/kb-setup-and-maintenance-source-pars-size-is-greater-than-maximum.html", "name": "source parts size is greater than the current maximum | blog", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "/#website", "url": "/", "name": "blog Help" }</script><!-- End Schema.org --></head>      <body data-id="kb-setup-and-maintenance_source-pars-size-is-greater-than-maximum" data-main-title="source parts size is greater than the current maximum" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Clickhouse///kb-setup-and-maintenance"  >   <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>blog 1.0 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="kb-setup-and-maintenance_source-pars-size-is-greater-than-maximum"   id="kb-setup-and-maintenance_source-pars-size-is-greater-than-maximum.md">source parts size is greater than the current maximum</h1>  <section class="chapter"><h2 id="source-parts-size-is-greater-than-the-current-maximum-linktitle-source-parts-sizeis-greater-than-the-current-maximum-weight-100-description-source-parts-size-is-greater-than-the-current-maximum" data-toc="source-parts-size-is-greater-than-the-current-maximum-linktitle-source-parts-sizeis-greater-than-the-current-maximum-weight-100-description-source-parts-size-is-greater-than-the-current-maximum"   >#source parts size is greater than the current maximum
linkTitle: &quot;source parts sizeis greater than the current maximum&quot;
weight: 100
description: &gt;-
source parts size (...) is greater than the current maximum (...)</h2></section><section class="chapter"><h2 id="symptom" data-toc="symptom"   >Symptom</h2><p id="1e599801_99">I see messages like: <code class="code" id="1e599801_100">source parts size (...) is greater than the current maximum (...)</code> in the logs and/or inside <code class="code" id="1e599801_101">system.replication_queue</code></p></section><section class="chapter"><h2 id="cause" data-toc="cause"   >Cause</h2><p id="1e599801_102">Usually that means that there are already few big merges running. You can see the running merges using the query:</p><div class="code-block" data-lang="none"         >
SELECT * FROM system.merges
</div><p id="1e599801_104">That logic is needed to prevent picking a log of huge merges simultaneously (otherwise they will take all available slots and clickhouse will not be able to do smaller merges, which usally are important for keeping the number of parts stable).</p></section><section class="chapter"><h2 id="action" data-toc="action"   >Action</h2><p id="1e599801_105">It is normal to see those messages on some stale replicas. And it should be resolved automatically after some time. So just wait &amp; monitor system.merges &amp; system.replication_queue tables, it should be resolved by it's own.</p><p id="1e599801_106">If it happens often or don't resolves by it's own during some longer period of time, it could be caused by:</p><ol class="list _decimal" id="1e599801_107" type="1"><li class="list__item" id="1e599801_108"><p>increased insert pressure</p></li><li class="list__item" id="1e599801_109"><p>disk issues / high load (it works slow, not enought space etc.)</p></li><li class="list__item" id="1e599801_110"><p>high CPU load (not enough CPU power to catch up with merges)</p></li><li class="list__item" id="1e599801_111"><p>issue with table schemas leading to high merges pressure (high / increased number of tables / partitions / etc.)</p></li></ol><p id="1e599801_112">Start from checking dmesg / system journals / clickhouse monitoring to find the anomalies.</p></section><div class="last-modified"> Last modified: 17 十二月 2023</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="kb-setup-and-maintenance-ssl-connection-unexpectedly-closed.html">SSL connection unexpectedly closed</a>   <a class="navigation-links__next" href="kb-setup-and-maintenance-recovery-after-complete-data-loss.html">recovery-after-complete-data-loss</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b205/app.js"></script></body></html>